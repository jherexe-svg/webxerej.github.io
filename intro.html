<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuestra Historia</title>

<style>
body{
  margin:0;
  background:black;
  overflow:hidden;
}

canvas{
  display:block;
}

button{
  position:fixed;
  bottom:60px;
  left:50%;
  transform:translateX(-50%);
  padding:12px 30px;
  border:none;
  border-radius:30px;
  background:#c91d34;
  color:white;
  font-size:14px;
  cursor:pointer;
  opacity:0;
  transition:1s ease;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>
<button id="btn" onclick="irGaleria()">Comenzar ðŸ’•</button>

<audio id="musica" loop>
  <source src="those-eyes.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
let stars = [];
let textIndex = 0;

const texts = [
  "Algunas historias.",
  "no empiezan con una citaâ€¦",
  "empiezan con una mirada.",
  "Y estaâ€¦",
  "es la nuestra."
];

class Particle{
  constructor(x,y){
    this.x = Math.random()*canvas.width;
    this.y = Math.random()*canvas.height;
    this.tx = x;
    this.ty = y;
    this.size = 2.5;
  }

  update(){
    this.x += (this.tx - this.x)*0.07;
    this.y += (this.ty - this.y)*0.07;
  }

  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle = "white";
    ctx.shadowColor = "white";
    ctx.shadowBlur = 12;
    ctx.fill();
    ctx.shadowBlur = 0;
  }

  explode(){
    this.tx = Math.random()*canvas.width;
    this.ty = Math.random()*canvas.height;
  }
}

class Star{
  constructor(){
    this.x = Math.random()*canvas.width;
    this.y = Math.random()*canvas.height;
    this.size = Math.random()*1.5;
    this.alpha = Math.random();
  }

  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle = `rgba(120,150,255,${this.alpha})`;
    ctx.fill();
  }
}

for(let i=0;i<200;i++){
  stars.push(new Star());
}

function createText(text){
  particles = [];
  ctx.clearRect(0,0,canvas.width,canvas.height);

  let fontSize = canvas.width < 500 ? 28 : 60;
  ctx.fillStyle="white";
  ctx.font=`bold ${fontSize}px Georgia`;
  ctx.textAlign="center";
  ctx.fillText(text, canvas.width/2, canvas.height/2);

  const data = ctx.getImageData(0,0,canvas.width,canvas.height).data;

  for(let y=0;y<canvas.height;y+=4){
    for(let x=0;x<canvas.width;x+=4){
      const index = (y * canvas.width + x) * 4;
      if(data[index+3] > 150){
        particles.push(new Particle(x,y));
      }
    }
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  stars.forEach(s=>s.draw());

  particles.forEach(p=>{
    p.update();
    p.draw();
  });

  requestAnimationFrame(animate);
}

function nextText(){
  if(textIndex < texts.length){

    particles.forEach(p=>p.explode());

    setTimeout(()=>{
      createText(texts[textIndex]);
      textIndex++;
      setTimeout(nextText,4000);
    },1000);

  } else {
    document.getElementById("btn").style.opacity=1;
  }
}

animate();
createText(texts[textIndex]);
textIndex++;
setTimeout(nextText,4000);

window.addEventListener("resize",()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

document.addEventListener("click", function(){
  const audio = document.getElementById("musica");
  audio.volume = 0.4;
  audio.play();
},{once:true});

function irGaleria(){
  document.body.style.opacity="0";
  document.body.style.transition="1s";
  setTimeout(()=>{
    window.location.href="galeria.html";
  },1000);
}
</script>

</body>
</html>
