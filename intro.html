<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuestra Historia</title>

<style>
body{
  margin:0;
  background:black;
  overflow:hidden;
}

canvas{
  display:block;
}

button{
  position:fixed;
  bottom:60px;
  left:50%;
  transform:translateX(-50%);
  padding:12px 30px;
  border:none;
  border-radius:30px;
  background:#ff2e63;
  color:white;
  font-size:14px;
  cursor:pointer;
  opacity:0;
  transition:1s ease;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>
<button id="btn" onclick="irGaleria()">Comenzar ðŸ’«</button>

<audio id="musica" loop>
  <source src="those-eyes.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
let stars = [];
let textIndex = 0;
let glowPulse = 0;

const texts = [
  "Algunas historias.",
  "no empiezan con una citaâ€¦",
  "empiezan con una mirada.",
  "Y estaâ€¦",
  "es la nuestra."
];

class Particle{
  constructor(x,y){
    this.x = Math.random()*canvas.width;
    this.y = Math.random()*canvas.height;
    this.tx = x;
    this.ty = y;
    this.size = 3;
  }

  update(){
    this.x += (this.tx - this.x)*0.08;
    this.y += (this.ty - this.y)*0.08;
  }

  draw(){
    const gradient = ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,10);
    gradient.addColorStop(0,"#ff4ecd");
    gradient.addColorStop(1,"#7a5cff");

    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle = gradient;

    ctx.shadowColor = "#ff4ecd";
    ctx.shadowBlur = 20 + Math.sin(glowPulse)*10;
    ctx.fill();
    ctx.shadowBlur = 0;
  }

  explode(){
    this.tx = Math.random()*canvas.width;
    this.ty = Math.random()*canvas.height;
  }
}

class Star{
  constructor(){
    this.x = Math.random()*canvas.width;
    this.y = Math.random()*canvas.height;
    this.size = Math.random()*2;
    this.speed = Math.random()*0.3;
  }

  update(){
    this.y += this.speed;
    if(this.y > canvas.height){
      this.y = 0;
      this.x = Math.random()*canvas.width;
    }
  }

  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle = "rgba(150,180,255,0.8)";
    ctx.fill();
  }
}

for(let i=0;i<300;i++){
  stars.push(new Star());
}

function drawNebula(){
  const gradient = ctx.createRadialGradient(
    canvas.width/2,canvas.height/2,0,
    canvas.width/2,canvas.height/2,canvas.width
  );
  gradient.addColorStop(0,"rgba(80,0,120,0.6)");
  gradient.addColorStop(0.5,"rgba(20,0,50,0.4)");
  gradient.addColorStop(1,"black");

  ctx.fillStyle = gradient;
  ctx.fillRect(0,0,canvas.width,canvas.height);
}

function createText(text){
  particles = [];
  ctx.clearRect(0,0,canvas.width,canvas.height);

  let fontSize = canvas.width < 500 ? 30 : 70;
  ctx.fillStyle="white";
  ctx.font=`bold ${fontSize}px Georgia`;
  ctx.textAlign="center";
  ctx.fillText(text, canvas.width/2, canvas.height/2);

  const data = ctx.getImageData(0,0,canvas.width,canvas.height).data;

  for(let y=0;y<canvas.height;y+=3){
    for(let x=0;x<canvas.width;x+=3){
      const index = (y * canvas.width + x) * 4;
      if(data[index+3] > 150){
        particles.push(new Particle(x,y));
      }
    }
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);
}

function animate(){
  glowPulse += 0.05;

  drawNebula();

  stars.forEach(s=>{
    s.update();
    s.draw();
  });

  particles.forEach(p=>{
    p.update();
    p.draw();
  });

  requestAnimationFrame(animate);
}

function nextText(){
  if(textIndex < texts.length){

    particles.forEach(p=>p.explode());

    setTimeout(()=>{
      createText(texts[textIndex]);
      textIndex++;
      setTimeout(nextText,4000);
    },1000);

  } else {
    document.getElementById("btn").style.opacity=1;
  }
}

animate();
createText(texts[textIndex]);
textIndex++;
setTimeout(nextText,4000);

window.addEventListener("resize",()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

document.addEventListener("click", function(){
  const audio = document.getElementById("musica");
  audio.volume = 0.5;
  audio.play();
},{once:true});

function irGaleria(){
  document.body.style.opacity="0";
  document.body.style.transition="1s";
  setTimeout(()=>{
    window.location.href="galeria.html";
  },1000);
}
</script>

</body>
</html>
